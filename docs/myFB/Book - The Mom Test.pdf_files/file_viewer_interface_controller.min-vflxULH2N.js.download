(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define(["jquery","modules/clean/comments/models/preview_types","modules/clean/event_emitter","modules/clean/frame_messenger"],function(t,n,r,i){var s;return s=function(){function s(t,i,s){switch(this._handleMessageFromWindow=e(this._handleMessageFromWindow,this),this._handleMessageFromChild=e(this._handleMessageFromChild,this),this._prepareImageInterface=e(this._prepareImageInterface,this),this._preparePdfJsInterface=e(this._preparePdfJsInterface,this),this.dispatchEvent=e(this.dispatchEvent,this),this._notifyEventsTriggered=e(this._notifyEventsTriggered,this),this.registerEventsCallbacks=e(this.registerEventsCallbacks,this),this._eventsHandler=null,this._eventEmitter=new r,this._previewType=i,this._previewSelector=s,this._previewType){case n.PDFJS:this._preparePdfJsInterface(t);break;case n.IMAGE:this._prepareImageInterface()}}return s.prototype.registerEventsCallbacks=function(e){return this._eventsHandler=e},s.prototype._notifyEventsTriggered=function(e,t){return"function"==typeof this._eventsHandler?this._eventsHandler(e,t):void 0},s.prototype.addListener=function(e,t){return this._eventEmitter.on(e,t)},s.prototype.removeListener=function(e,t){return this._eventEmitter.off(e,t)},s.prototype.once=function(e,t){return this._eventEmitter.once(e,t)},s.prototype.on=s.prototype.addListener,s.prototype.off=s.prototype.removeListener,s.prototype.dispatchEvent=function(e,t){switch(this._previewType){case n.PDFJS:return this._frameMessenger.postMessageToChildren(e,t);case n.IMAGE:return window.postMessage(JSON.stringify({action:e,parameters:t}),"*")}},s.prototype.destroy=function(){var e;switch(this._eventEmitter.removeAllListeners(),this._eventsHandler=null,this._previewType){case n.PDFJS:return null!=(e=this._frameMessenger)?e.stopListening():void 0;case n.IMAGE:return window.removeEventListener("message",this._handleMessageFromWindow)}},s.prototype._preparePdfJsInterface=function(e){return this._frameMessenger=new i,this._frameMessenger.configureChildMessaging(this._getIframeQuery(),t.proxy(this._handleMessageFromChild,this),["annotation-hidden","annotation-placed","annotation-start-drag","annotation-end-drag","annotation-ui-enter","annotation-ui-over","annotation-ui-leave","annotation-ui-click","annotation-enter","annotation-leave","page-rendered","scroll","scale-change","on-keydown","mouse-up"]),this._frameMessenger.startListening()},s.prototype._prepareImageInterface=function(){return window.addEventListener("message",this._handleMessageFromWindow)},s.prototype._getIframeQuery=function(){return"#pdf-embed-iframe"},s.prototype._handleMessageFromChild=function(e){return this._eventEmitter.emit(e.action,e.parameters),"function"==typeof this._notifyEventsTriggered?this._notifyEventsTriggered(e.action,e.parameters):void 0},s.prototype._handleMessageFromWindow=function(e){var t,n,r;try{r=JSON.parse(e.data)}catch(e){return void(t=e)}return this._eventEmitter.emit(r.action,r.parameters),"function"==typeof this._notifyEventsTriggered?this._notifyEventsTriggered(r.action,r.parameters):void 0},s}()})}).call(this);
//# sourceMappingURL=file_viewer_interface_controller.min.js-vfldBoTEc.map